{
  "name": "Leads - Procesador de Excel para Prospección",
  "description": "Recibe una carga masiva de clientes potenciales desde un archivo Excel, valida los datos y los prepara para el filtrado.",
  "tags": ["leads", "prospeccion", "excel", "masivo", "srp"],
  "nodes": [
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "webhook/leads/excel-upload",
        "responseMode": "responseNode",
        "options": {}
      },
      "id": "webhook-trigger",
      "name": "Webhook Carga Excel Leads",
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2,
      "position": [240, 300]
    },
    {
      "parameters": {
        "jsCode": "const webhookData = $input.first().json;\n\n
      },
      "id": "process-excel-data",
      "name": "1. Procesar Datos Excel",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [460, 300]
    },
    {
      "parameters": {
        "operation": "create",
        "resource": "execution",
        "workflowId": "filtro-leads-existentes",
        "data": "={{ JSON.stringify($json) }}"
      },
      "id": "trigger-filter-workflow",
      "name": "2. Disparar Filtro de Duplicados",
      "type": "n8n-nodes-base.n8n",
      "typeVersion": 2,
      "position": [680, 300]
    },
    {
      "parameters": {
        "respondWith": "json",
        "responseBody": "={\n  \"status\": \"success\",\n  \"message\": \"Archivo Excel recibido. Iniciando proceso de validación y filtrado de leads.\",\n  \"clients_processed\": {{ $('1. Procesar Datos Excel').first().json.clients_from_excel.length }}\n}"
      },
      "id": "success-response",
      "name": "Respuesta Exitosa",
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 2,
      "position": [900, 300]
    }
  ],
  "connections": {
    "Webhook Carga Excel Leads": {
      "main": [
        [
          {
            "node": "1. Procesar Datos Excel",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "1. Procesar Datos Excel": {
      "main": [
        [
          {
            "node": "2. Disparar Filtro de Duplicados",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "2. Disparar Filtro de Duplicados": {
      "main": [
        [
          {
            "node": "Respuesta Exitosa",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "settings": { "saveExecutionProgress": true }
}